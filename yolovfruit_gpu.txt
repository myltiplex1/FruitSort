For GPU

install python 3.9.23
git clone https://github.com/ultralytics/yolov5
py -3.9 -m venv fruit_env
.\fruit_env\Scripts\activate
cd yolov5
pip install -r requirements.txt
pip uninstall torch torchvision -y
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu126 (This command installs PyTorch 2.7.0, which supports CUDA 12.6 and is compatible with Python 3.9.23, as per the PyTorch installation guide)
Verify the installation and CUDA support: python
import torch
print(torch.__version__)  # Expected: 2.7.0+cu126
print(torch.cuda.is_available())  # Expected: True
print(torch.version.cuda)  # Expected: 12.6
print(torch.cuda.get_device_name(0))  # Expected: NVIDIA GeForce RTX 3060
cd yolov5
python xml_to_yolo.py

dataset/
├── images/
│   ├── train/
│   │   ├── 001.jpg
│   │   ├── 002.jpg
│   │   └── ...
│   │   └── 696.jpg
│   ├── val/
├── labels/
│   ├── train/
│   │   ├── 001.txt
│   │   ├── 002.txt
│   │   └── ...
│   │   └── 696.txt
│   ├── val/

train: dataset/images/train/
val: dataset/images/val/
nc: 3  # Number of classes
names: ["apple", "banana", "orange"]  # Class names

python train.py --img 640 --batch 16 --epochs 50 --data data.yaml --weights yolov5s.pt --device 0
python val.py --data data.yaml --weights runs/train/expX/weights/best.pt --img 640
python detect.py --source path/to/test/images --weights runs/train/expX/weights/best.pt --img 640
pip install onnx>=1.12.0
python export.py --weights runs/train/expX/weights/best.pt --img 640 --include onnx
python export.py --weights runs/train/expX/weights/best.pt --img 640 --include onnx --optimize
pip install onnxsim
python -m onnxsim runs/train/expX/weights/best.onnx runs/train/expX/weights/best_simplified.onnx




